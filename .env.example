# ============================================================================
# MULTI-TIER AGENT ECOSYSTEM - ENVIRONMENT VARIABLES
# ============================================================================
# Copy this file to .env and fill in your actual values
# NEVER commit .env to git - it contains secrets!

# ============================================================================
# LLM API KEYS (REQUIRED)
# ============================================================================

# OpenRouter API Key (Primary LLM provider)
# Get your key from: https://openrouter.ai/keys
OPENROUTER_API_KEY=sk-or-v1-your-key-here

# Google AI API Key (Fallback provider)
# Get your key from: https://aistudio.google.com/apikey
GOOGLE_API_KEY=AIzaSy-your-key-here

# ============================================================================
# APPLICATION SECRETS (REQUIRED)
# ============================================================================

# JWT Secret Key (MUST be 32+ characters)
# Generate with: openssl rand -hex 32
# Or: python -c "import secrets; print(secrets.token_hex(32))"
JWT_SECRET_KEY=your-super-secret-jwt-key-minimum-32-characters-long-change-this

# Chainlit Auth Secret (for UI authentication)
# Generate with: openssl rand -hex 32
CHAINLIT_AUTH_SECRET=your-chainlit-auth-secret-change-this-32-chars-min

# Encryption Key (for sensitive data encryption)
# Generate with: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
ENCRYPTION_KEY=your-fernet-encryption-key-here

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================

# PostgreSQL Database (defaults for local development)
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_DB=agent_ecosystem
POSTGRES_USER=agent_user
POSTGRES_PASSWORD=agent_password_secure_123

# PostgreSQL Admin (for migrations and admin tasks)
POSTGRES_ADMIN_USER=postgres
POSTGRES_ADMIN_PASSWORD=postgres_admin_password

# Connection Pool Settings
POSTGRES_POOL_MIN_SIZE=5
POSTGRES_POOL_MAX_SIZE=20

# ============================================================================
# REDIS CONFIGURATION
# ============================================================================

REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# Redis Connection Settings
REDIS_MAX_CONNECTIONS=50
REDIS_SOCKET_TIMEOUT=5

# ============================================================================
# MINIO (S3-COMPATIBLE STORAGE)
# ============================================================================

MINIO_ENDPOINT=minio:9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin123
MINIO_BUCKET=agent-artifacts
MINIO_SECURE=false
MINIO_REGION=us-east-1

# ============================================================================
# APPLICATION SETTINGS
# ============================================================================

# Environment (development, staging, production)
ENVIRONMENT=development

# Logging Level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO

# Budget Control
MAX_MONTHLY_BUDGET=20.0
TOKEN_COST_PER_1K_INPUT=0.001
TOKEN_COST_PER_1K_OUTPUT=0.002

# Workflow Timeouts (seconds)
WORKFLOW_TIMEOUT_SECONDS=14400  # 4 hours
AGENT_TIMEOUT_SECONDS=300       # 5 minutes per agent
LLM_CALL_TIMEOUT_SECONDS=120    # 2 minutes per LLM call

# Rejection Limits
MAX_REJECTION_COUNT=3
MAX_ROLLBACK_DEPTH=2

# ============================================================================
# RATE LIMITING
# ============================================================================

RATE_LIMIT_ENABLED=true
RATE_LIMIT_PER_MINUTE=50
RATE_LIMIT_PER_HOUR=1000

# ============================================================================
# OBSERVABILITY
# ============================================================================

# LangSmith (Optional - for advanced tracing)
LANGCHAIN_TRACING_V2=false
LANGCHAIN_ENDPOINT=https://api.smith.langchain.com
LANGCHAIN_API_KEY=ls__your-key-here
LANGCHAIN_PROJECT=multi-tier-agent-ecosystem

# Prometheus Metrics
PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=9090

# Grafana
GRAFANA_ADMIN_PASSWORD=admin

# ============================================================================
# EXTERNAL SERVICES (OPTIONAL)
# ============================================================================

# GitHub Integration (for Commit Agent)
GITHUB_TOKEN=ghp_your-github-token-here
GITHUB_REPO_OWNER=your-username
GITHUB_REPO_NAME=your-repo

# Sentry (Error Tracking)
SENTRY_DSN=
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=0.1

# ============================================================================
# SECURITY SETTINGS
# ============================================================================

# CORS (Comma-separated list of allowed origins)
CORS_ORIGINS=http://localhost:8080,http://localhost:3000

# Session Settings
SESSION_COOKIE_NAME=agent_session
SESSION_COOKIE_SECURE=false  # Set to true in production with HTTPS
SESSION_COOKIE_HTTPONLY=true
SESSION_COOKIE_SAMESITE=lax
SESSION_MAX_AGE=86400  # 24 hours

# ============================================================================
# FEATURE FLAGS
# ============================================================================

# Enable/Disable Optional Agents
ENABLE_DEVIATION_HANDLER=true
ENABLE_STRATEGY_VALIDATOR=true
ENABLE_STATIC_ANALYSIS=true
ENABLE_OBSERVABILITY_AGENT=true
ENABLE_DOCUMENTATION_AGENT=true
ENABLE_COMMIT_AGENT=false  # Disabled by default

# Human Approval Gates (true = pause for human review)
HUMAN_APPROVAL_TIER_0=false
HUMAN_APPROVAL_TIER_1=false
HUMAN_APPROVAL_TIER_2=false
HUMAN_APPROVAL_TIER_3=false
HUMAN_APPROVAL_TIER_4=true
HUMAN_APPROVAL_FINAL=true

# ============================================================================
# DEVELOPMENT SETTINGS
# ============================================================================

# Hot Reload (uvicorn --reload)
HOT_RELOAD=true

# Debug Mode
DEBUG=false

# Pretty Print Logs (false for production)
LOG_PRETTY_PRINT=true

# Test Database (separate from main DB)
TEST_POSTGRES_DB=agent_ecosystem_test

# ============================================================================
# PERFORMANCE TUNING
# ============================================================================

# Worker Processes (uvicorn --workers)
WEB_WORKERS=1

# Max Request Size (bytes)
MAX_REQUEST_SIZE=10485760  # 10MB

# Connection Keepalive (seconds)
KEEPALIVE_TIMEOUT=65

# ============================================================================
# BACKUP & RETENTION
# ============================================================================

# Checkpoint Retention
CHECKPOINT_RETENTION_DAYS=2
MAX_CHECKPOINTS_PER_WORKFLOW=10

# Log Retention
LOG_RETENTION_DAYS=30

# Artifact Retention (MinIO)
ARTIFACT_RETENTION_DAYS=90

# Database Backup Schedule (cron format)
BACKUP_SCHEDULE="0 2 * * *"  # Daily at 2 AM

# ============================================================================
# DOCKER COMPOSE OVERRIDES
# ============================================================================

# Port Mappings (if defaults conflict)
# FASTAPI_PORT=8000
# CHAINLIT_PORT=8080
# POSTGRES_PORT=5432
# REDIS_PORT=6379
# MINIO_API_PORT=9000
# MINIO_CONSOLE_PORT=9001
# PROMETHEUS_PORT=9090
# GRAFANA_PORT=3000

# ============================================================================
# NOTES
# ============================================================================

# 1. Generate secure secrets:
#    - JWT_SECRET_KEY: openssl rand -hex 32
#    - CHAINLIT_AUTH_SECRET: openssl rand -hex 32
#    - ENCRYPTION_KEY: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
#
# 2. For production:
#    - Change all passwords and secrets
#    - Set ENVIRONMENT=production
#    - Set MINIO_SECURE=true (with HTTPS)
#    - Set SESSION_COOKIE_SECURE=true
#    - Disable DEBUG and HOT_RELOAD
#    - Use strong database passwords
#
# 3. Required for workflow execution:
#    - OPENROUTER_API_KEY (Primary)
#    - GOOGLE_API_KEY (Fallback)
#    - JWT_SECRET_KEY (32+ chars)
#
# 4. Optional but recommended:
#    - LANGCHAIN_API_KEY (for tracing)
#    - GITHUB_TOKEN (for Commit Agent)
#    - SENTRY_DSN (for error tracking)

# ============================================================================
# VALIDATION
# ============================================================================
# Run: poetry run python scripts/validate_env.py
# To verify all required variables are set correctly
