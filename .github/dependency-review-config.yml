# Dependency Review Configuration
# This file defines rules for the dependency-review-action
# https://github.com/actions/dependency-review-action

# Fail the check if a vulnerability with this severity or higher is detected
fail-on-severity: high

# List of licenses that are explicitly allowed (use allowlist approach)
allow-licenses:
  - MIT
  - Apache-2.0
  - BSD-3-Clause
  - BSD-2-Clause
  - ISC
  - MPL-2.0           # Allow pytest-rerunfailures
  - PSF-2.0           # Python Software Foundation (used by stdlib)
  - 0BSD              # Zero-Clause BSD (very permissive)
  - Unlicense         # Public domain

# Note: deny-licenses is specified in the workflow file to avoid conflicts
# You can only use allow-licenses OR deny-licenses, not both

# Fail if any dependency is removed (useful to prevent supply chain attacks)
fail-on-scopes:
  - runtime

# Allow dependencies from these registries only (optional)
# Uncomment if you want to restrict to specific package sources
# allow-ghsas:
#   - GHSA-xxxx-xxxx-xxxx

# Package-level license exceptions for dependencies with complex/unknown metadata
allow-dependencies-licenses:
  - pkg:pypi/aiohappyeyeballs
  - pkg:pypi/protobuf
  - pkg:pypi/opentelemetry-instrumentation-voyageai
  - pkg:pypi/mcp
  - pkg:pypi/multidict
  - pkg:pypi/python-multipart